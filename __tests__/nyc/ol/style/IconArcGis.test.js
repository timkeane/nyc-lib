import IconArcGis from 'nyc/ol/style/IconArcGis'
import Feature from 'ol/Feature'

const json = '{"currentVersion":10.7,"id":0,"name":"Cooling_centers_for_DoITT_test","type":"Feature Layer","serviceItemId":"5928530b20fb46e589cc8f8285d27784","displayField":"FACILITY_NAME","description":"","copyrightText":"","defaultVisibility":true,"editingInfo":{"lastEditDate":1583188048813},"relationships":[],"isDataVersioned":false,"supportsAppend":true,"supportsCalculate":true,"supportsASyncCalculate":true,"supportsTruncate":true,"supportsAttachmentsByUploadId":true,"supportsAttachmentsResizing":true,"supportsRollbackOnFailureParameter":true,"supportsStatistics":true,"supportsExceedsLimitStatistics":true,"supportsAdvancedQueries":true,"supportsValidateSql":true,"supportsCoordinatesQuantization":true,"supportsFieldDescriptionProperty":true,"supportsQuantizationEditMode":true,"supportsApplyEditsWithGlobalIds":false,"supportsReturningQueryGeometry":true,"advancedQueryCapabilities":{"supportsPagination":true,"supportsPaginationOnAggregatedQueries":true,"supportsQueryRelatedPagination":true,"supportsQueryWithDistance":true,"supportsReturningQueryExtent":true,"supportsStatistics":true,"supportsOrderBy":true,"supportsDistinct":true,"supportsQueryWithResultType":true,"supportsSqlExpression":true,"supportsAdvancedQueryRelated":true,"supportsCountDistinct":true,"supportsPercentileStatistics":true,"supportsLod":true,"supportsQueryWithLodSR":false,"supportedLodTypes":["geohash"],"supportsReturningGeometryCentroid":false,"supportsQueryWithDatumTransformation":true,"supportsHavingClause":true,"supportsOutFieldSQLExpression":true,"supportsMaxRecordCountFactor":true,"supportsTopFeaturesQuery":true,"supportsDisjointSpatialRel":true,"supportsQueryWithCacheHint":true},"useStandardizedQueries":false,"geometryType":"esriGeometryPoint","minScale":0,"maxScale":0,"extent":{"xmin":922476.009691134,"ymin":125021.0403623134,"xmax":1063131.2546268106,"ymax":269056.99999322,"spatialReference":{"wkid":102718,"latestWkid":2263}},"drawingInfo":{"renderer":{"type":"uniqueValue","field1":"FACILITY_TYPE","field2":"HANDICAP_ACCESS","field3":null,"defaultSymbol":null,"defaultLabel":null,"uniqueValueInfos":[{"symbol":{"type":"esriPMS","url":"0b014bac46df80bf4e02363fec4a9f14","imageData":"iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAfBJREFUOI2t1E9LG0EYBvB31lkzySZsAtEYQjBtoLGKEBCLpa0XpauHYg85lJZS8dbPUDz4HfQWoYkHFU+KUMRChNaTl0pAiW310GqauLZu/uxO3KzjKdrVpEmkz3Fe5jc8wzAY/lNwrQFjzH9mnI3lSjm/bujEiq150SomEaBVhFCxLsQYs55SZerTj83BjfRGWDNUS2XmIZ6M5JfG1bK6YMO2WE2IMeY4yh/NxVLx0byeb71+SIZmPPGv8ZFusbtLoco9kYjvqkLZYnYmujv7jBqUq1UZAGBH2QnAd/amQAsHdmKPmiCtrEnLeytSPeQK2/WFlfA4Y2weIVS8hDKF7Ovt0+32RpBK1n9+fBB0BSMAELuE/mi/Q80gAADHpWNeVuXHJkg3dFezEAAANagT4K87QgiVbwNxiCubIIKJDABN1SMtBEgLOTRB9lbHZ7fF/UguyQ1DD9sGci6La8YEBZydk8O+oRcL+4udjSAO7IC7YjAhEOHABCGE9JSceiv5pKW1wzWhXqXnd8a+CRbby8qa6WWH3KEPyV/JV5FAJJpIJ9wnpZMbSI/YA33tfV94jJ967V61KgQA0NvRu7yV3lof9Y9Mazp9ohmal7FzgjmcE3hhn+f49/fbuqav76v6jfR7+1UAmPhXvYag2+QC4ze0OLAOpq0AAAAASUVORK5CYII=","contentType":"image/png","width":13,"height":13,"angle":0,"xoffset":0,"yoffset":0},"value":"Community center,No","label":"Community center","description":""},{"symbol":{"type":"esriPMS","url":"ff508c242812f4c5fa379156bc391051","imageData":"iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAiZJREFUOI2tlMtrE1EUh8+dzDQ3mYRpIG0MITQaMH1QCJSKwcdGcdqF1EUWooilO/+FGVy4aHe6ancRTFxYcVURXFSwoDKLglgClvhoF2pr0lQ7ecxMOhlvVxNmxhmk4G91OI/v3Hvu5dDwn0R7BQghyUPjcKbRaSR1Q8cBOtDkAlwZAXqBEGr/E0QICRxo8r03395dXNtdy6qG4jdjMRyr8kl+Vukqy0E6WPQEEULCO82dx8VKabqpN/ucTapaNVb6XJoa5UaHZU0+zWFOdAXV2rWlwubDq5qhUaZvITcPgiT2bAAAQRJT8JXcbmmt7RAOFWwgtavyK5+e8ybELHLapj7Km4msnJ0lhDxBCLV7oGqrdmvjYGPQmuw8idUHALD6/dWZdCSdB4BiD/Rb/ZU5DgQAYK+zx9SV+nkbSDf0iDXJ7TqWGfV8mqH1A1hmhBDqWgusyW5QUxSiujYQpnEdADJuyYIk9uBWKPZhwD78wwYK9YXfRv3Rc6qhenZ3KjdwthHxR5ZsoFT/0N3LiUvXl7eeDrldz6kwHYZTXPo1i9ltGwghpFfqlTt8gn8mSCK7kJt3fTFBEgH7MFw7OfOF9QdvmHHbz85EMy/LP8s386l84f77B9H9zv5fJxnjxmBicOIDQ9NX4qG44goCABg/Mb6yvru+Op2cWlR17YJqqHFC/mCaohssw24xFPNoZGB40VnnukYm45MKAMx5DshFnvvouDoCnJLaJl+t8WsAAAAASUVORK5CYII=","contentType":"image/png","width":13,"height":13,"angle":0,"xoffset":0,"yoffset":0},"value":"Community center,Yes","label":"Community center, Accessible","description":""},{"symbol":{"type":"esriPMS","url":"9fc3cb91716279939fd5397819fd97be","imageData":"iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAdJJREFUOI2t1Ltrk1EYx/HvE2NsbvbtBTWUYpfaglAitQpa3WrqjQ6KBC+0dKiI4uQgiJA66B9gIygdGkQMXoaAUCSCIiIUFaouDmIdjDZoNY28r7FRHwdJ8C2JSYq/8Ryez+F3OBwn/ynOchuq2ppbYODLPK35PHUeN1+bDF6KcEdEzIqQqrrnMowmHrL9wl2CUyYrCnuDLaRP7mbIsjTu8UisLKSq/rfvuTpymZ3JeVyLD4mlWB27Qn8kSOfnjK5rNORMSSiVJhqOsnfKxFGuMkBkmjZVBjNZnTFWyrgNMr9p6OItQpWQQkaf0xLqZkhVr4uIWYTepTly+imrqkEKiU6yqaud/UCsCM3O0VELAnDtA8sjH+m1Qd8XaKgVArByGPDXHYmDH0uBRP7MFSGfm09QW73NXvC5SdmgBj+PwmvYGp+tHjrRS7apkagN6mjj7PF+wvEJ1laD9NVDsJ379V6ZsUEikn/2So/dHuDmvgTeSpXOH+B1s4+DhTXby+7ulMnHL/TQg8OMX7pH840SNc9tgF09TDtgRyAgVkkIYEuXJJJPNHlqD2NHc2wzLQI/f1HnWkbW8PPG5WRi43oZWzxX8hvp6xELGP5XvaqgpeQ3GkqPAgnuhiEAAAAASUVORK5CYII=","contentType":"image/png","width":13,"height":13,"angle":0,"xoffset":0,"yoffset":0},"value":"Cornerstone Program,No","label":"Cornerstone Program","description":""},{"symbol":{"type":"esriPMS","url":"21b4eb000edc01e2fb629e3bcdf79719","imageData":"iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAfxJREFUOI2tlEtoE1EUhr8TY2xedvpADaXYTW1BKJFaBW3d1dQX3YgGrbS4UESRWbgQRGhdqMuCzULpokFE8bEoCEWyUESEooKPjQuxLowmaDWNzBgb9boomc6ME6Tgv7rcc/7v3HPu5fr5T/JXCyilmkvz9H+do7lcpiYU5FuDxisR7oqI8U+QUio4W2Bk8iHbLtwjPm2wohIbbCJ/chdDpqluhEKSrgpSSkXffeDqkcvsyMwRcBdJZ1mdvkLfcJz2LwW1rl6TM56gbJ5UMsWeaQOfBR8F0RfXAKLTohSDhaKa0VbKuANkfFeJS7dJVCAVk3td0cgLmhKdDCmlrouIYYHe5zl0+imr7Mnuk9j3AFJTbOpoZS+QtkC5WdqWAgG49pHlw5/odoB+zFNnT/JqxzYjS2YJDWwzEh8/7QZ7shfU8smCzwJFgnwGZ3tWsr4It0M3hyESJOsA1UV5lFzD1pxZvbpbJ7opNtSTcoDaWjh7vI9kzwRrvdpzq7cW4q3crw3LjAMkIuVnr9WxO/3cEp2wGvW+MdEXWjq/jzeNEQ5U4o6X3dkuU49fqoMPBhjff5HGm7m/T3JuA+zs4rkPtsdiYnqCALZ0yGTmicqc2s3Y0RI9hkns129qAssoalHeBvxMbFwvY26f5zfS2yUmcLjqgDxU9T9aqv4A2W+prT+QyiIAAAAASUVORK5CYII=","contentType":"image/png","width":13,"height":13,"angle":0,"xoffset":0,"yoffset":0},"value":"Cornerstone Program,Yes","label":"Cornerstone Program, Accessible","description":""},{"symbol":{"type":"esriPMS","url":"61976fbddc23a17c98210cdeb27bcaa1","imageData":"iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAfdJREFUOI1jYaASYMEl8f//f9lfv377f3z3Sfb3778cnFzsnwWE+C4zMjJuYWRk/ErQoP///3N+ePep8dCOU3Y7Fx4z+Pr2JztMTlpL5KV3on3Ct28/VnBxcSzEadD///95nz16uXhm/WrPj0+/sqFb8vTaG/FZpWs9DNxVND68/6QmIMhXjdWgl8/eTp1autz36/ufTLi8zMDAwHBh5x2F////x3/6+OU+Hz/PHBSDvn//7r5mzk53QobAwMVdd6WN7R8l/P//fzkjI+NXuEEvH7+JPbPphhgxhsDA9iVHzFR1lEIYGBgWwg16++aDOimGMDAwMDy//o719fM3NigG/fr5W5BUgxgYGBh+fP8pwMCAFEZMjIx/yDGIkZHpD4pBnNwcbxgYGEjyHrcgOwMnF/tTFIN4+bmPSKgJWb+49Y5og2xCDD4JCfFPRTFIQVW21iPWOmJB7WZ5Ygzhl+JmUNVW2M/Nz30fxSBGRsbfNy7eyfTPt1u9ceIhbkJeCst3u8MjJBoFE0NJ2Rr6KtsvnboeHVPvNWfPshMiL25jetPQU5XB1FH3AgMbk5ukJM83rAYxMDAw6Jlpbjy9+/Run2T7KT++frf99u2n5L+//ziYWZk/8fJz32NhZVmgbag2BV0f1mLE1NX0GwMDQxI+7xFlEDkAAHtJtD+Kl0mpAAAAAElFTkSuQmCC","contentType":"image/png","width":13,"height":13,"angle":0,"xoffset":0,"yoffset":0},"value":"Library,No","label":"Library","description":""},{"symbol":{"type":"esriPMS","url":"c2bd1fc5b0433b6c12eddc6d83f08894","imageData":"iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAipJREFUOI1jYaASYMEl8f//f9lfv377f3z3Sfb3778cnFzsnwWE+C4zMjJuYWRk/ErQoP///3N+ePep8dCOU3Y7Fx4z+Pr2JztMTlpL5KV3on3Ct28/VnBxcSzEadD///95nz16uXhm/WrPj0+/sqFb8vTaG/FZpWs9DNxVND68/6QmIMhXjdWgl8/eTp1autz36/ufTDCxCbvKGQrcOuFsBgYGhgK3ToX////Hf/r45T4fP88cFIO+f//uvmbOTneYITBN6GwYuLjrrrSx/aOE////L2dkZPwKN+jl4zexZzbdEENWjO4SZDEGBgaG7UuOmKnqKIUwMDAshBv09s0HdVIMYWBgYHh+/R3r6+dvbFAM+vXztyCyImzeQQojuNiP7z8FGBiQwoiJkfEPsgZkxdgMhQFGRqY/KAZxcnO8YWBgUMemuMCtE244sqHcguwMnFzsT1EM4uXnPiKhJmT97cN3nLajA5sQg09CQvxTUQxSUJWt9Yi1jlhQu1kem/fQAb8UN4OqtsJ+bn7u+ygGMTIy/r5x8U6mf77d6gK3Tu4Ju8qxxliBWycDtyA7Q1i+2x0eIdEomDxKytbQV9l+6dT16Jh6rzkd2bNFXtx+h+ESQ09VBlNH3QsMbExukpI837AaxMDAwKBnprnx9O7Tu32S7af8+Prd9tu3n5L//v7jYGZl/sTLz32PhZVlgbah2hR0fViLEVNX028MDAxJOAMIC8BZHpEKAOfs2yj1BXDAAAAAAElFTkSuQmCC","contentType":"image/png","width":13,"height":13,"angle":0,"xoffset":0,"yoffset":0},"value":"Library,Yes","label":"Library, Accessible","description":""},{"symbol":{"type":"esriPMS","url":"626c8432aecc97c1e91db14bea805290","imageData":"iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAfBJREFUOI2t1M9LVFEUB/Bz7rze78kxpcnK0o2GkBhGQb92NhVEi1oMhSgtilBatQgiGFvUH5DTykVDREPRQghazKICKaYIgmCQiHSh1ETqU999+Hz3vdNqsqczzYx0lvdwP4fv5XAl+E8lVWoQUSutiHNiwWklT6hMl5elJuMzIL5ARF4VIiJNzNkjy+OFE/zeZA/lhVLqRQbMYvT6/sHAcbNMVzIVISKKrk7PPVq4MnE6yLny+iF+xo5bmXenlFR8n5jnHdI241ZZaHXWSs8n35ylvGCVIgMAuKlim0XvB4TlTEkxfSwECe4mFu/nE9WQP0NHfu5yE8VBInqCiHwNmrH63Zvft9eClMpOFw6p3TsvAEBmDfphd9aDAAD4j+0tXso6FoLIFY31QgAA5HgxgL8fG1FsBgJkIgQxU/4FAHXFw8MSoCnPhqFGdSKSNI762Q1LW7G04fYlqclMhyC1M347GOpKLmY/7K0FYX0KyD3xV1KDOhWCENFzPs5cM553PePnC0a1SNG7B75qzQ0XS2ehzdZ7d7/kb6cvbX3dO8YfTDb7TzfGVO7sAO1M+6eAwUlsMZ2yEACAcaRt3M59yUVvdI/6V1eOE/dayA9UlCNLLKZ9Y3LkoX5wz+j6e2W/EbOvwwGAy/+KVxO0mfoN3Ae2squi4AgAAAAASUVORK5CYII=","contentType":"image/png","width":13,"height":13,"angle":0,"xoffset":0,"yoffset":0},"value":"School,No","label":"School","description":""},{"symbol":{"type":"esriPMS","url":"90f69bb51360caa4905cdd65b05b9646","imageData":"iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAhxJREFUOI2tlM9LFGEYx59ndpqd2ZnNNaVtK0svbgiJYSRUdrOtILqELUUoHYooOnUIItAO9Qfk3jy0RBQTHYSiwx4qkGKLIAgkItKDMiqpo84MjvPOPp1md2aaIYS+p4fnx+d53+f9wcN/Eh8XIKI22mDn2IrVRg4TuZSwzrfI3wDxFSKa/wQRkcSWjNH1iakT5sPvPVRlSS+WGFIW0rcODtcs+zmXSpZjQUSU3pxZerJydfJ0rWIL4SZu2cjq5Y+nkiPZA2zZ7OR3yHcjQZtzemm5+P4sVRnn+XI0CBqqdRsAQEO1XadPQ0y3pvlMajwAYqZdWH1ULXgQryhs15uOLu6xCwvDRPQMEc0GaFa/bN/RdvqTwyvx+wAAjNLUEbF793kAKDdA80Z+KxAAAPepsc0Z0Y8HQGSzZn9S1HZ8M6r7yHIyAP5hIzJ/gT85Ctqo41gAxCnCbwDIR+VqqNbhfij28YCKMBcENYuTiaJ8jOad+O4hSTc71vgWpRQAifnsvdqNruJq/+f9UdsLixtIgtCTfcs3idMBECI61pfZ6/LLrhcaqnKOBiNPTEMVsI+H9INDP6XWpotePHCzU71735gfZi5tf9c7vnjhdaur/vU2IXl/F0hnOr7WODiJOcWKBAEAyEfbJ4zKj0r6dveYe22jn0wnR25NRCGxxmWkX5yQeJw6vG8sXBf5jSgDnRYAXIkdUIRi/6Ot6g9Jxd0Q6Vqw9wAAAABJRU5ErkJggg==","contentType":"image/png","width":13,"height":13,"angle":0,"xoffset":0,"yoffset":0},"value":"School,Yes","label":"School, Accessible","description":""},{"symbol":{"type":"esriPMS","url":"8ed06768e51fabffc150f44c25e9c1aa","imageData":"iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAfVJREFUOI1jYaASYMEl8f//f9m/v374f//0Xvbf798crJzcnzn5hS4zMDJuYWRk/ErQoP///3N+//C28f7hLXaPD/Qa/Pl+kx0mxynu/lLJPTfh17dvK9i4uBbiNOj///+8H589XHxpYa7n789n2NAt+f5yp/jVRTs9BLWyNb5/fK/GyS9YjdWgz6+eTr04J8H3z4+bTLi8zMDAwPD+2lSF6wx/4398+XCfg0dgDopBv75/db+2cao7IUMQhs2QfmfglvD////ljIyMX+EGfXn5JPbtxX4xYgyBgQe7Z5iJKOuGMDAwLIQb9O39S3VSDGFgYGD4/noX65c3z21QDPr7+6cgqQYxMDAw/PnxTYCBASmMGBkZ/5BjECMTRB/cIBYOnjcMDAwkeY+FQ52BlYPnKYpB7DwCRzhEnKx/vNlHtEESlimfOASFp6IYJKSgXivvkhVxc8U+eWIMYeU1YhBS0t/Pwc1/H8UgRkbG369uns9UcJ+2+sHOLG5CXlINaLjDyS0SBRdDViCmbrj96eUT0WohK+Y82j9T5Mfb/RiGCGnnMkgau19gYGV045GU/IbVIAYGBgZpXYuNz0/v3q3kWTDl9/cU2z/fv0r+//+Xg4mF9RMbt8A9Jla2BRKaxlMwXInN6ZKmrt8YGBiS8HmPKIPIAQDhuLNJ9DBXbgAAAABJRU5ErkJggg==","contentType":"image/png","width":13,"height":13,"angle":0,"xoffset":0,"yoffset":0},"value":"Senior center,No","label":"Senior center","description":""},{"symbol":{"type":"esriPMS","url":"8a8715e44f39ade4eaabf8a0f59ccfb3","imageData":"iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAipJREFUOI1jYaASYMEl8f//f9m/v374f//0Xvbf798crJzcnzn5hS4zMDJuYWRk/ErQoP///3N+//C28f7hLXaPD/Qa/Pl+kx0mxynu/lLJPTfh17dvK9i4uBbiNOj///+8H589XHxpYa7n789n2NAt+f5yp/jVRTs9BLWyNb5/fK/GyS9YjdWgz6+eTr04J8H3z4+bTDAxp7ZnDPuqpOBsBgYGhn1VUgrXGf7G//jy4T4Hj8AcFIN+ff/qfm3jVHeYITBN6GwYeH9thvQ7A7eE////L2dkZPwKN+jLyyexby/2iyErRncJshgDAwPDg90zzESUdUMYGBgWwg369v6lOimGMDAwMHx/vYv1y5vnNigG/f39UxBZETbvIIURXOzPj28CDAxIYcTIyPgHWQOyYmyGwvUxQfTBDWLh4HnDwMCgjk3xviopuOHIhrJwqDOwcvA8RTGInUfgCIeIk/Wf769w2o4OJCxTPnEICk9FMUhIQb1W3iUr4uaKEHls3kMHrLxGDEJK+vs5uPnvoxjEyMj4+9XN85kK7tNW76uS4nZqe4Y1xvZVSTGwcKgzqAY03OHkFomCexPZFjF1w+1PL5+IVgtZMedYb7TIj7f7MVwipJ3LIGnsfoGBldGNR1LyG1aDGBgYGKR1LTY+P717t5JnwZTf31Ns/3z/Kvn//18OJhbWT2zcAveYWNkWSGgaT0HXh7UYkTR1/cbAwJCEM4CwAJzlEakAAJdf2d/WBPr4AAAAAElFTkSuQmCC","contentType":"image/png","width":13,"height":13,"angle":0,"xoffset":0,"yoffset":0},"value":"Senior center,Yes","label":"Senior center, Accessible","description":""}],"fieldDelimiter":","},"transparency":0,"labelingInfo":null},"allowGeometryUpdates":true,"hasAttachments":false,"htmlPopupType":"esriServerHTMLPopupTypeAsHTMLText","hasM":false,"hasZ":false,"objectIdField":"OBJECTID","uniqueIdField":{"name":"OBJECTID","isSystemMaintained":true},"globalIdField":"","typeIdField":"FACILITY_TYPE","fields":[{"name":"OBJECTID","type":"esriFieldTypeOID","alias":"OBJECTID","sqlType":"sqlTypeOther","nullable":false,"editable":false,"domain":null,"defaultValue":null},{"name":"FACILITY_NAME","type":"esriFieldTypeString","alias":"FACILITY_NAME","sqlType":"sqlTypeOther","length":75,"nullable":true,"editable":true,"domain":null,"defaultValue":null},{"name":"ADDRESS","type":"esriFieldTypeString","alias":"ADDRESS","sqlType":"sqlTypeOther","length":50,"nullable":true,"editable":true,"domain":null,"defaultValue":null},{"name":"BOROUGH","type":"esriFieldTypeString","alias":"BOROUGH","sqlType":"sqlTypeOther","length":25,"nullable":true,"editable":true,"domain":null,"defaultValue":null},{"name":"ZIP_CODE","type":"esriFieldTypeString","alias":"ZIP_CODE","sqlType":"sqlTypeOther","length":10,"nullable":true,"editable":true,"domain":null,"defaultValue":null},{"name":"PHONE","type":"esriFieldTypeString","alias":"PHONE","sqlType":"sqlTypeOther","length":30,"nullable":true,"editable":true,"domain":null,"defaultValue":null},{"name":"HANDICAP_ACCESS","type":"esriFieldTypeString","alias":"HANDICAP_ACCESS","sqlType":"sqlTypeOther","length":3,"nullable":true,"editable":true,"domain":null,"defaultValue":null},{"name":"EXTENDED_HOURS","type":"esriFieldTypeString","alias":"EXTENDED_HOURS","sqlType":"sqlTypeOther","length":46,"nullable":true,"editable":true,"domain":null,"defaultValue":null},{"name":"HOURS","type":"esriFieldTypeString","alias":"HOURS","sqlType":"sqlTypeOther","length":110,"nullable":true,"editable":true,"domain":null,"defaultValue":null},{"name":"STATUS","type":"esriFieldTypeString","alias":"STATUS","sqlType":"sqlTypeOther","length":6,"nullable":true,"editable":true,"domain":null,"defaultValue":null},{"name":"FACILITY_TYPE","type":"esriFieldTypeString","alias":"FACILITY_TYPE","sqlType":"sqlTypeOther","length":50,"nullable":true,"editable":true,"domain":null,"defaultValue":null},{"name":"Entrance_info","type":"esriFieldTypeString","alias":"Entrance_info","sqlType":"sqlTypeOther","length":75,"nullable":true,"editable":true,"domain":null,"defaultValue":null}],"indexes":[{"name":"PK__CCS_TEST__F4B70D858366F218","fields":"OBJECTID","isAscending":true,"isUnique":true,"description":""},{"name":"user_1986.CCS_TEST_FOR_DOITT_COOLING_CENTERS_FOR_DOITT_TEST_Shape_sidx","fields":"Shape","isAscending":true,"isUnique":false,"description":""}],"types":[{"id":"Community center","name":"Community center","domains":{},"templates":[{"name":"Community center, No","description":"","drawingTool":"esriFeatureEditToolPoint","prototype":{"attributes":{"FACILITY_TYPE":"Community center","Entrance_info":null,"FACILITY_NAME":null,"ADDRESS":null,"BOROUGH":null,"ZIP_CODE":null,"PHONE":null,"HANDICAP_ACCESS":"No","EXTENDED_HOURS":null,"HOURS":null,"STATUS":null}}},{"name":"Community center, Yes","description":"","drawingTool":"esriFeatureEditToolPoint","prototype":{"attributes":{"FACILITY_TYPE":"Community center","Entrance_info":null,"FACILITY_NAME":null,"ADDRESS":null,"BOROUGH":null,"ZIP_CODE":null,"PHONE":null,"HANDICAP_ACCESS":"Yes","EXTENDED_HOURS":null,"HOURS":null,"STATUS":null}}}]},{"id":"Cornerstone Program","name":"Cornerstone Program","domains":{},"templates":[{"name":"Cornerstone Program, No","description":"","drawingTool":"esriFeatureEditToolPoint","prototype":{"attributes":{"FACILITY_TYPE":"Cornerstone Program","Entrance_info":null,"FACILITY_NAME":null,"ADDRESS":null,"BOROUGH":null,"ZIP_CODE":null,"PHONE":null,"HANDICAP_ACCESS":"No","EXTENDED_HOURS":null,"HOURS":null,"STATUS":null}}},{"name":"Cornerstone Program, Yes","description":"","drawingTool":"esriFeatureEditToolPoint","prototype":{"attributes":{"FACILITY_TYPE":"Cornerstone Program","Entrance_info":null,"FACILITY_NAME":null,"ADDRESS":null,"BOROUGH":null,"ZIP_CODE":null,"PHONE":null,"HANDICAP_ACCESS":"Yes","EXTENDED_HOURS":null,"HOURS":null,"STATUS":null}}}]},{"id":"Library","name":"Library","domains":{},"templates":[{"name":"Library, No","description":"","drawingTool":"esriFeatureEditToolPoint","prototype":{"attributes":{"FACILITY_TYPE":"Library","Entrance_info":null,"FACILITY_NAME":null,"ADDRESS":null,"BOROUGH":null,"ZIP_CODE":null,"PHONE":null,"HANDICAP_ACCESS":"No","EXTENDED_HOURS":null,"HOURS":null,"STATUS":null}}},{"name":"Library, Yes","description":"","drawingTool":"esriFeatureEditToolPoint","prototype":{"attributes":{"FACILITY_TYPE":"Library","Entrance_info":null,"FACILITY_NAME":null,"ADDRESS":null,"BOROUGH":null,"ZIP_CODE":null,"PHONE":null,"HANDICAP_ACCESS":"Yes","EXTENDED_HOURS":null,"HOURS":null,"STATUS":null}}}]},{"id":"School","name":"School","domains":{},"templates":[{"name":"School, No","description":"","drawingTool":"esriFeatureEditToolPoint","prototype":{"attributes":{"FACILITY_TYPE":"School","Entrance_info":null,"FACILITY_NAME":null,"ADDRESS":null,"BOROUGH":null,"ZIP_CODE":null,"PHONE":null,"HANDICAP_ACCESS":"No","EXTENDED_HOURS":null,"HOURS":null,"STATUS":null}}},{"name":"School, Yes","description":"","drawingTool":"esriFeatureEditToolPoint","prototype":{"attributes":{"FACILITY_TYPE":"School","Entrance_info":null,"FACILITY_NAME":null,"ADDRESS":null,"BOROUGH":null,"ZIP_CODE":null,"PHONE":null,"HANDICAP_ACCESS":"Yes","EXTENDED_HOURS":null,"HOURS":null,"STATUS":null}}}]},{"id":"Senior center","name":"Senior center","domains":{},"templates":[{"name":"Senior center, No","description":"","drawingTool":"esriFeatureEditToolPoint","prototype":{"attributes":{"FACILITY_TYPE":"Senior center","Entrance_info":null,"FACILITY_NAME":null,"ADDRESS":null,"BOROUGH":null,"ZIP_CODE":null,"PHONE":null,"HANDICAP_ACCESS":"No","EXTENDED_HOURS":null,"HOURS":null,"STATUS":null}}},{"name":"Senior center, Yes","description":"","drawingTool":"esriFeatureEditToolPoint","prototype":{"attributes":{"FACILITY_TYPE":"Senior center","Entrance_info":null,"FACILITY_NAME":null,"ADDRESS":null,"BOROUGH":null,"ZIP_CODE":null,"PHONE":null,"HANDICAP_ACCESS":"Yes","EXTENDED_HOURS":null,"HOURS":null,"STATUS":null}}}]}],"templates":[],"supportedQueryFormats":"JSON, geoJSON, PBF","hasStaticData":false,"maxRecordCount":1000,"standardMaxRecordCount":32000,"standardMaxRecordCountNoGeometry":32000,"tileMaxRecordCount":8000,"maxRecordCountFactor":1,"capabilities":"Query"}'
const layerInfo = JSON.parse(json)

test('constructor', () => {
  expect.assertions(2)

  const icon = new IconArcGis(layerInfo.drawingInfo.renderer)

  expect(icon.renderer).toBe(layerInfo.drawingInfo.renderer)

  try {
    new IconArcGis({type: 'notWhatYouWant'})
  } catch (err) {
    expect(err.message).toBe('Only supports unique value rendering')
  }
})

test('style', () => {
  expect.assertions(4)

  const icon = new IconArcGis(layerInfo.drawingInfo.renderer)

  const f0 = new Feature({FACILITY_TYPE: 'Community center', HANDICAP_ACCESS: 'No'})
  const f1 = new Feature({FACILITY_TYPE: 'Library', HANDICAP_ACCESS: 'Yes'})

  let style = icon.style(f0, 32)

  expect(style.getImage().getSrc()).toBe('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAfBJREFUOI2t1E9LG0EYBvB31lkzySZsAtEYQjBtoLGKEBCLpa0XpauHYg85lJZS8dbPUDz4HfQWoYkHFU+KUMRChNaTl0pAiW310GqauLZu/uxO3KzjKdrVpEmkz3Fe5jc8wzAY/lNwrQFjzH9mnI3lSjm/bujEiq150SomEaBVhFCxLsQYs55SZerTj83BjfRGWDNUS2XmIZ6M5JfG1bK6YMO2WE2IMeY4yh/NxVLx0byeb71+SIZmPPGv8ZFusbtLoco9kYjvqkLZYnYmujv7jBqUq1UZAGBH2QnAd/amQAsHdmKPmiCtrEnLeytSPeQK2/WFlfA4Y2weIVS8hDKF7Ovt0+32RpBK1n9+fBB0BSMAELuE/mi/Q80gAADHpWNeVuXHJkg3dFezEAAANagT4K87QgiVbwNxiCubIIKJDABN1SMtBEgLOTRB9lbHZ7fF/UguyQ1DD9sGci6La8YEBZydk8O+oRcL+4udjSAO7IC7YjAhEOHABCGE9JSceiv5pKW1wzWhXqXnd8a+CRbby8qa6WWH3KEPyV/JV5FAJJpIJ9wnpZMbSI/YA33tfV94jJ967V61KgQA0NvRu7yV3lof9Y9Mazp9ohmal7FzgjmcE3hhn+f49/fbuqav76v6jfR7+1UAmPhXvYag2+QC4ze0OLAOpq0AAAAASUVORK5CYII=')
  expect(style.getImage().getScale()).toBe(32 / 13)

  style = icon.style(f1, 19)

  expect(style.getImage().getSrc()).toBe('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAipJREFUOI1jYaASYMEl8f//f9lfv377f3z3Sfb3778cnFzsnwWE+C4zMjJuYWRk/ErQoP///3N+ePep8dCOU3Y7Fx4z+Pr2JztMTlpL5KV3on3Ct28/VnBxcSzEadD///95nz16uXhm/WrPj0+/sqFb8vTaG/FZpWs9DNxVND68/6QmIMhXjdWgl8/eTp1autz36/ufTDCxCbvKGQrcOuFsBgYGhgK3ToX////Hf/r45T4fP88cFIO+f//uvmbOTneYITBN6GwYuLjrrrSx/aOE////L2dkZPwKN+jl4zexZzbdEENWjO4SZDEGBgaG7UuOmKnqKIUwMDAshBv09s0HdVIMYWBgYHh+/R3r6+dvbFAM+vXztyCyImzeQQojuNiP7z8FGBiQwoiJkfEPsgZkxdgMhQFGRqY/KAZxcnO8YWBgUMemuMCtE244sqHcguwMnFzsT1EM4uXnPiKhJmT97cN3nLajA5sQg09CQvxTUQxSUJWt9Yi1jlhQu1kem/fQAb8UN4OqtsJ+bn7u+ygGMTIy/r5x8U6mf77d6gK3Tu4Ju8qxxliBWycDtyA7Q1i+2x0eIdEomDxKytbQV9l+6dT16Jh6rzkd2bNFXtx+h+ESQ09VBlNH3QsMbExukpI837AaxMDAwKBnprnx9O7Tu32S7af8+Prd9tu3n5L//v7jYGZl/sTLz32PhZVlgbah2hR0fViLEVNX028MDAxJOAMIC8BZHpEKAOfs2yj1BXDAAAAAAElFTkSuQmCC')
  expect(style.getImage().getScale()).toBe(19 / 13)
})

describe('fetch', () => {
  beforeEach(() => {
    fetch.mockReset()
  })
  afterEach(() => {
    fetch.mockReset()
  })

  test('fetch success', done => {
    expect.assertions(1)

    fetch.mockResponseOnce(json)

    IconArcGis.fetch('mock-url').then(icon => {
      expect(icon.renderer).toEqual(layerInfo.drawingInfo.renderer)
      done()
    })
  })

  test('fetch fail', done => {
    expect.assertions(2)

    fetch.mockResponseOnce('{}')

    IconArcGis.fetch('mock-url').then(icon => {
      expect(true).toBe(false)
    }).catch(err => {
      expect(err.message).toBe('Unable to load drawingInfo from mock-url')
      expect(
        err.cause.message === "Cannot read property 'renderer' of undefined"
        ||
        err.cause.message === "Cannot read properties of undefined (reading 'renderer')"
      ).toBe(true)
      done()
    })
  })

})